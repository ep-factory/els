<?php

/**
 * Fiche
 * 
 * This class has been auto-generated by the Doctrine ORM Framework
 * 
 * @package    els
 * @subpackage model
 * @author     Vincent CHALAMON <vincentchalamon@gmail.com>
 * @version    SVN: $Id: Builder.php 7490 2010-03-29 19:53:27Z jwage $
 */
class Fiche extends BaseFiche
{
  public function postHydrate($event) {
    parent::postHydrate($event);
    // Retrieve changed/installed elements
    $this->_values['changed_elements'] = new Doctrine_Collection('Element');
    $this->_values['installed_elements'] = new Doctrine_Collection('Element');
    foreach($this->getFicheElement() as $object) {
      if($object->getOperationType() == "changed") {
        $this->_values['changed_elements']->add($object->getElement());
      }
      else {
        $this->_values['installed_elements']->add($object->getElement());
      }
    }
    // Retrieve parent
    $this->_values['parent'] = false;
    if($this->getParentId() != $this->getPrimaryKey()) {
      $this->_values['parent'] = $this->getTable()->find($this->getParentId());
    }
  }

  public function hasParent() {
    return $this->getParentId() != $this->getPrimaryKey();
  }
}
